@model IEnumerable<WebApp.Models.FeedBackViewModel>

@{
    ViewData["Title"] = "Feedback List";
    Layout = "_DashboardLayout";
}

<h1 class="mb-4">Feedback List</h1>

<!-- Notifications for errors or success messages -->
@if (TempData["Error"] != null)
{
    <div class="alert alert-danger">
        @TempData["Error"]
    </div>
}
@if (TempData["Success"] != null)
{
    <div class="alert alert-success">
        @TempData["Success"]
    </div>
}

<table class="table table-hover">
    <thead>
        <tr class="table-dark">
            <th>Feedback ID</th>
            <th>Full Name</th>
            <th>Subject</th>
            <th>Status</th>
            <th>Created At</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var feedback in Model)
        {
            <tr>
                <td>@feedback.FeedbackId</td>
                <td>@feedback.FullName</td>
                <td>@feedback.Subject</td>
                <td>@feedback.Status</td>
                <td>@feedback.CreateAt.ToString("g")</td>
                <td>
                    <!-- Buttons to trigger modals for each action -->
                    <button class="btn btn-info btn-sm" onclick="details(@feedback.FeedbackId)">Details</button>
                    <button class="btn btn-primary btn-sm" onclick="edit(@feedback.FeedbackId)">Edit</button>
                    <button class="btn btn-danger btn-sm" onclick="deleteAction(@feedback.FeedbackId)">Delete</button>
                </td>
            </tr>
        }
    </tbody>
</table>

@if (!Model.Any())
{
    <div class="alert alert-info">
        No feedbacks found.
    </div>
}

<!-- Modal Structure -->
<div class="modal fade" id="feedbackModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content" id="feedbackModalContent">
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function details(id) {
            var url = '@Url.Action("Details", "Feedback", new { id = "__id__" })'.replace("__id__", id);
            $.get(url, function (response) {
                $('#feedbackModalContent').html(response);
                $('#feedbackModal').modal('show');
            });
        }

        function edit(id) {
            var url = '@Url.Action("Edit", "Feedback", new { id = "__id__" })'.replace("__id__", id);
            $.get(url, function (response) {
                $('#feedbackModalContent').html(response);
                $('#feedbackModal').modal('show');
            });
        }

        function deleteAction(id) {
            var url = '@Url.Action("Delete", "Feedback", new { id = "__id__" })'.replace("__id__", id);
            $.get(url, function (response) {
                $('#feedbackModalContent').html(response);
                $('#feedbackModal').modal('show');
            });
        }
    </script>
}
