@model IEnumerable<WebApp.Models.TableViewModel>
@{
    ViewData["Title"] = "Tables";
    Layout = "_DashboardLayout";
}

<h1 class="mb-4 text-center">Table Management</h1>

<div class="mb-3">
    <button onclick="create()" class="btn btn-success">Add New Table</button>
</div>

<div class="container">
    <div class="row">
        @foreach (var table in Model)
        {
            var cardColor = table.Status switch
            {
                Models.Entities.TableStatus.Available => "#84e88b",
                Models.Entities.TableStatus.Reserved => "#F00000",
                Models.Entities.TableStatus.Occupied => "#F00000",
                Models.Entities.TableStatus.Cleaning => "#9EE7FB",
                Models.Entities.TableStatus.Unavailable => "#C8D7DB"
            };

            <div class="col-md-3 mb-4">
                <div class="text-decoration-none" onclick="details(@table.TableId)">
                    <div class="card shadow-sm h-100" style="background-color: @cardColor; width: 100%; height: 0; padding-bottom: 100%; position: relative;">
                        <div class="card-body d-flex flex-column align-items-center justify-content-center" style="position: absolute; top: 0; bottom: 0; left: 0; right: 0; color: black;">
                            <h5 class="card-title text-center">@table.TableName</h5>
                            <p class="card-text text-center mb-1"><strong>Capacity:</strong> @table.Capacity</p>
                            <p class="card-text text-center"><strong>Status:</strong> @table.Status</p>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<!-- Modal for AJAX-driven actions -->
<div class="modal fade" id="modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content" id="modalContent">
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function create() {
            var url = '@Url.Action("Create", "Table")';
            $.get(url, function (response) {
                $('#modalContent').html(response);
                $('#modal').modal('show');
            });
        }

        function details(id) {
            var url = '@Url.Action("Details", "Table", new { id = "__id__" })'.replace("__id__", id);
            $.get(url, function (response) {
                $('#modalContent').html(response);
                $('#modal').modal('show');
            });
        }

        function edit(id) {
            var url = '@Url.Action("Edit", "Table", new { id = "__id__" })'.replace("__id__", id);
            $.get(url, function (response) {
                $('#modalContent').html(response);
                $('#modal').modal('show');
            });
        }

     
    </script>
}
